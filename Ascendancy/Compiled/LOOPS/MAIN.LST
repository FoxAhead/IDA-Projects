
Module: C:\WATCOM\PROJECTS\LOOPS\main.cpp
Group: 'DGROUP' CONST,CONST2,_DATA,_BSS

Segment: _TEXT  PARA USE32  000000da bytes  

#include <stdio.h>
#pragma pack(1)


// Definitions

typedef signed char         BYTE;
typedef signed long int     LONG;
typedef signed short int    WORD;
typedef unsigned char       UBYTE;
typedef unsigned long int   ULONG;
typedef unsigned short int  UWORD;
typedef int BOOL;


// Types

typedef struct {
  //T_WndA2 super;
  //P_Wnd10LB pPlayerDipListBox;
  //P_Wnd10LB pAlienDipListBox;
  //P_Wnd02COSW pCosWnd;
  int Unknown_B7;
  WORD Unknown_BB;
  WORD Unknown_BD;
  WORD Unknown_BF;
  WORD Unknown_C1;
} T_Wnd21NW;

typedef T_Wnd21NW *P_Wnd21NW;

typedef struct {
  UBYTE index;
  UBYTE species;
  UBYTE colorSet;
  BOOL extinct;
  BYTE ability;
  int daysAfterAbilityUse;
  int Unknown_1A2[2];
  WORD shipPatience;
  WORD attitudes[7];
  BYTE treaties[7];
  WORD negPlayerTurns;
  WORD declareWar;
  WORD acceptPeace;
  WORD proposePeace;
  WORD breakAlliance;
  WORD acceptAlliance;
  WORD proposeAlliance;
  WORD startAttitude;
  WORD bioPeriod;
  WORD bioMaxpositve;
  WORD bioMaxnegative;
  float bioSinX;
  float bioSinHalfX;
  float bioSinTwiceX;
  char Unknown_1E9;
  int Unknown_1EA;
} T_Race;

typedef struct {
  int day;
  WORD _combatSearchIndex;
  T_Race races[7];
  WORD racesNum;
  BYTE atmosphere;
} T_Game;

#pragma pack(1)

// Glabals 

T_Game  V_Game;
int     V_PlayerRaceIndex;
BYTE    byte_968DD;

// Implementation

void Q_Wnd21NW_sub_32658(P_Wnd21NW pNegWnd)
{
  WORD i; // dx
  WORD Unknown_C1; // ax
  
 0000                    void near Q_Wnd21NW_sub_32658( __1oprc1T_Wnd21NW near * ):
 0000  53                                push    ebx
 0001  51                                push    ecx
 0002  52                                push    edx
 0003  56                                push    esi
 0004  57                                push    edi
 0005  55                                push    ebp
 0006  89 e5                             mov     ebp,esp
 0008  81 ec 0c 00 00 00                 sub     esp,0000000cH
 000e  89 45 fc                          mov     -4H[ebp],eax

  for ( i = 0; i < V_Game.racesNum; ++i )
  {
 0011  c7 45 f4 00 00 00 
       00                                mov     dword ptr -0cH[ebp],00000000H
 0018  eb 03                             jmp     L2
 001a  ff 45 f4          L1              inc     dword ptr -0cH[ebp]
 001d  8b 45 f4          L2              mov     eax,-0cH[ebp]
 0020  66 3b 05 44 02 00 
       00                                cmp     ax,__2fh2u0T_Game near V_Game+244H
 0027  0f 8d 7c 00 00 00                 jge     L10

    if ( i != V_PlayerRaceIndex && i != byte_968DD && V_Game.races[i].extinct != 0xFFFFFFFF && V_Game.races[V_PlayerRaceIndex].treaties[i] )
    {
 002d  0f bf 45 f4                       movsx   eax,word ptr -0cH[ebp]
 0031  3b 05 00 00 00 00                 cmp     eax,int near V_PlayerRaceIndex
 0037  74 10                             je      L3
 0039  0f bf 55 f4                       movsx   edx,word ptr -0cH[ebp]
 003d  a1 fd ff ff ff                    mov     eax,char signed near byte_968DD-3H
 0042  c1 f8 18                          sar     eax,18H
 0045  39 c2                             cmp     edx,eax
 0047  75 02                             jne     L4
 0049  eb 10             L3              jmp     L5
 004b  0f bf 45 f4       L4              movsx   eax,word ptr -0cH[ebp]
 004f  6b c0 52                          imul    eax,52H
 0052  83 b8 09 00 00 00 
       ff                                cmp     dword ptr __2fh2u0T_Game near V_Game+9H[eax],0ffffffffH
 0059  75 02                             jne     L6
 005b  eb 16             L5              jmp     L7
 005d  6b 15 00 00 00 00 
       52                L6              imul    edx,int near V_PlayerRaceIndex,52H
 0064  0f bf 45 f4                       movsx   eax,word ptr -0cH[ebp]
 0068  01 d0                             add     eax,edx
 006a  80 b8 2a 00 00 00 
       00                                cmp     byte ptr __2fh2u0T_Game near V_Game+2aH[eax],00H
 0071  75 02                             jne     L8
 0073  eb 2f             L7              jmp     L9

      if ( V_Game.races[byte_968DD].treaties[i] )
      {
 0075  a1 fd ff ff ff    L8              mov     eax,char signed near byte_968DD-3H
 007a  c1 f8 18                          sar     eax,18H
 007d  6b d0 52                          imul    edx,eax,52H
 0080  0f bf 45 f4                       movsx   eax,word ptr -0cH[ebp]
 0084  01 d0                             add     eax,edx
 0086  80 b8 2a 00 00 00 
       00                                cmp     byte ptr __2fh2u0T_Game near V_Game+2aH[eax],00H
 008d  74 15                             je      L9

        Unknown_C1 = pNegWnd->Unknown_C1;
 008f  8b 45 fc                          mov     eax,-4H[ebp]
 0092  66 8b 40 0a                       mov     ax,+0aH[eax]
 0096  89 45 f8                          mov     -8H[ebp],eax

        pNegWnd->Unknown_C1 = Unknown_C1 + 1;
        //word_96842[Unknown_C1] = i;
      }
 0099  8b 45 f8                          mov     eax,-8H[ebp]
 009c  40                                inc     eax
 009d  8b 55 fc                          mov     edx,-4H[ebp]
 00a0  66 89 42 0a                       mov     +0aH[edx],ax

    }
  }
 00a4  e9 71 ff ff ff    L9              jmp     L1

};


// Main

 00a9  89 ec             L10             mov     esp,ebp
 00ab  5d                                pop     ebp
 00ac  5f                                pop     edi
 00ad  5e                                pop     esi
 00ae  5a                                pop     edx
 00af  59                                pop     ecx
 00b0  5b                                pop     ebx
 00b1  c3                                ret     
 00b2  8b c0                             mov     eax,eax

void main()
{
  T_Wnd21NW NegWnd;
  
 00b4  53                main_           push    ebx
 00b5  51                                push    ecx
 00b6  52                                push    edx
 00b7  56                                push    esi
 00b8  57                                push    edi
 00b9  55                                push    ebp
 00ba  89 e5                             mov     ebp,esp
 00bc  81 ec 0c 00 00 00                 sub     esp,0000000cH

  byte_968DD = 1;
 00c2  c6 05 00 00 00 00 
       01                                mov     byte ptr char signed near byte_968DD,01H

  Q_Wnd21NW_sub_32658(&NegWnd);
 00c9  8d 45 f4                          lea     eax,-0cH[ebp]
 00cc  e8 00 00 00 00                    call    void near Q_Wnd21NW_sub_32658( __1oprc1T_Wnd21NW near * )

};

 00d1  89 ec                             mov     esp,ebp
 00d3  5d                                pop     ebp
 00d4  5f                                pop     edi
 00d5  5e                                pop     esi
 00d6  5a                                pop     edx
 00d7  59                                pop     ecx
 00d8  5b                                pop     ebx
 00d9  c3                                ret     

No disassembly errors

------------------------------------------------------------

Segment: _BSS  DWORD USE32  0000024d bytes  

No disassembly errors

------------------------------------------------------------

Segment: $$SYMBOLS  BYTE USE16  000000e3 bytes  
 0000  0f 12                                   - ..
 0002  00 00 00 00 00 00                       DP      __2fh2u0T_Game near V_Game
 0008  2c 56 5f 47 61 6d 65 1a                 - ,V_Game.
 0010  12                                      - .
 0011  00 00 00 00 00 00                       DP      int near V_PlayerRaceIndex
 0017  0c 56 5f 50 6c 61 79 65                 - .V_Playe
 001f  72 52 61 63 65 49 6e 64                 - rRaceInd
 0027  65 78 13 12                             - ex..
 002b  00 00 00 00 00 00                       DP      char signed near byte_968DD
 0031  1d 62 79 74 65 5f 39 36                 - .byte_96
 0039  38 44 44 08 32                          - 8DD.2
 003e  00 00 00 00 00 00                       DP      void near Q_Wnd21NW_sub_32658( __1oprc1T_Wnd21NW near * )
 0044  0c 23 75 00 00 00 2f 00                 - .#u.../.
 004c  00 00 50 00 0c 23 75 00                 - ..P..#u.
 0054  00 00 2f 00 00 00 5c 00                 - ../...\.
 005c  0c 23 2d 00 00 00 77 00                 - .#-...w.
 0064  00 00 68 00 0c 23 2d 00                 - ..h..#-.
 006c  00 00 77 00 00 00 74 00                 - ..w...t.
 0074  2a 24 00 00 00 00 b2 00                 - *$......
 007c  00 00 00 00 0e 09 18 00                 - ........
 0084  00 00 32 00 01 30 1c 51                 - ..2..0.Q
 008c  5f 57 6e 64 32 31 4e 57                 - _Wnd21NW
 0094  5f 73 75 62 5f 33 32 36                 - _sub_326
 009c  35 38 0c 11 10 fc 31 70                 - 58....1p
 00a4  4e 65 67 57 6e 64 06 11                 - NegWnd..
 00ac  10 f4 1b 69 0f 11 10 f8                 - ...i....
 00b4  1b 55 6e 6b 6e 6f 77 6e                 - .Unknown
 00bc  5f 43 31 19 24 b4 00 00                 - _C1.$...
 00c4  00 26 00 00 00 00 00 0e                 - .&......
 00cc  09 18 00 00 00 33 00 00                 - .....3..
 00d4  6d 61 69 6e 0b 11 10 f4                 - main....
 00dc  2f 4e 65 67 57 6e 64                    - /NegWnd

No disassembly errors

------------------------------------------------------------

Segment: $$TYPES  BYTE USE16  000003ac bytes  
 0000  06 13 ac 03 00 00 06 11                 - ........
 0008  65 6e 75 6d 07 11 75 6e                 - enum..un
 0010  69 6f 6e 08 11 73 74 72                 - ion..str
 0018  75 63 74 07 11 63 6c 61                 - uct..cla
 0020  73 73 0c 10 11 5f 5f 73                 - ss...__s
 0028  65 67 6d 65 6e 74 07 10                 - egment..
 0030  10 63 68 61 72 03 10 00                 - .char...
 0038  03 10 10 03 10 11 03 10                 - ........
 0040  01 03 10 11 06 10 03 69                 - .......i
 0048  6e 74 0f 10 13 75 6e 73                 - nt...uns
 0050  69 67 6e 65 64 20 69 6e                 - igned in
 0058  74 03 10 03 03 10 13 03                 - t.......
 0060  10 23 03 10 27 03 10 30                 - .#..'..0
 0068  03 46 12 04 72 13 00 03                 - .F..r...
 0070  46 14 08 60 03 00 0c 00                 - F..`....
 0078  00 00 0f 67 01 84 22 08                 - ...g..".
 0080  69 0d 5f 5f 69 6e 64 65                 - i.__inde
 0088  78 0f 67 01 84 22 04 69                 - x.g..".i
 0090  0d 5f 5f 64 65 6c 74 61                 - .__delta
 0098  09 67 01 6b 15 5f 5f 66                 - .g.k.__f
 00a0  6e 08 12 00 0c 42 4f 4f                 - n....BOO
 00a8  4c 09 12 00 0b 55 57 4f                 - L....UWO
 00b0  52 44 09 12 00 0f 55 4c                 - RD....UL
 00b8  4f 4e 47 09 12 00 08 55                 - ONG....U
 00c0  42 59 54 45 08 12 00 0a                 - BYTE....
 00c8  57 4f 52 44 08 12 00 0e                 - WORD....
 00d0  4c 4f 4e 47 08 12 00 07                 - LONG....
 00d8  42 59 54 45 0a 12 00 0e                 - BYTE....
 00e0  66 70 6f 73 5f 74 03 46                 - fpos_t.F
 00e8  06 04 20 00 1f 0d 12 00                 - .. .....
 00f0  20 5f 5f 76 61 5f 6c 69                 -  __va_li
 00f8  73 74 0a 12 00 0d 73 69                 - st....si
 0100  7a 65 5f 74 04 20 01 0c                 - ze_t. ..
 0108  04 20 06 1b 04 20 06 1d                 - . ... ..
 0110  08 60 1a 00 52 00 00 00                 - .`..R...
 0118  0f 61 4e 0c 55 6e 6b 6e                 - .aN.Unkn
 0120  6f 77 6e 5f 31 45 41 0f                 - own_1EA.
 0128  61 4d 06 55 6e 6b 6e 6f                 - aM.Unkno
 0130  77 6e 5f 31 45 39 10 61                 - wn_1E9.a
 0138  49 10 62 69 6f 53 69 6e                 - I.bioSin
 0140  54 77 69 63 65 58 0f 61                 - TwiceX.a
 0148  45 10 62 69 6f 53 69 6e                 - E.bioSin
 0150  48 61 6c 66 58 0b 61 41                 - HalfX.aA
 0158  10 62 69 6f 53 69 6e 58                 - .bioSinX
 0160  12 61 3f 1b 62 69 6f 4d                 - .a?.bioM
 0168  61 78 6e 65 67 61 74 69                 - axnegati
 0170  76 65 11 61 3d 1b 62 69                 - ve.a=.bi
 0178  6f 4d 61 78 70 6f 73 69                 - oMaxposi
 0180  74 76 65 0d 61 3b 1b 62                 - tve.a;.b
 0188  69 6f 50 65 72 69 6f 64                 - ioPeriod
 0190  11 61 39 1b 73 74 61 72                 - .a9.star
 0198  74 41 74 74 69 74 75 64                 - tAttitud
 01a0  65 13 61 37 1b 70 72 6f                 - e.a7.pro
 01a8  70 6f 73 65 41 6c 6c 69                 - poseAlli
 01b0  61 6e 63 65 12 61 35 1b                 - ance.a5.
 01b8  61 63 63 65 70 74 41 6c                 - acceptAl
 01c0  6c 69 61 6e 63 65 11 61                 - liance.a
 01c8  33 1b 62 72 65 61 6b 41                 - 3.breakA
 01d0  6c 6c 69 61 6e 63 65 10                 - lliance.
 01d8  61 31 1b 70 72 6f 70 6f                 - a1.propo
 01e0  73 65 50 65 61 63 65 0f                 - sePeace.
 01e8  61 2f 1b 61 63 63 65 70                 - a/.accep
 01f0  74 50 65 61 63 65 0e 61                 - tPeace.a
 01f8  2d 1b 64 65 63 6c 61 72                 - -.declar
 0200  65 57 61 72 12 61 2b 1b                 - eWar.a+.
 0208  6e 65 67 50 6c 61 79 65                 - negPlaye
 0210  72 54 75 72 6e 73 0c 61                 - rTurns.a
 0218  24 25 74 72 65 61 74 69                 - $%treati
 0220  65 73 0d 61 16 24 61 74                 - es.a.$at
 0228  74 69 74 75 64 65 73 10                 - titudes.
 0230  61 14 1b 73 68 69 70 50                 - a..shipP
 0238  61 74 69 65 6e 63 65 0f                 - atience.
 0240  61 0c 23 55 6e 6b 6e 6f                 - a.#Unkno
 0248  77 6e 5f 31 41 32 17 61                 - wn_1A2.a
 0250  08 0c 64 61 79 73 41 66                 - ..daysAf
 0258  74 65 72 41 62 69 6c 69                 - terAbili
 0260  74 79 55 73 65 0b 61 07                 - tyUse.a.
 0268  1d 61 62 69 6c 69 74 79                 - .ability
 0270  0b 61 03 17 65 78 74 69                 - .a..exti
 0278  6e 63 74 0c 61 02 1a 63                 - nct.a..c
 0280  6f 6c 6f 72 53 65 74 0b                 - olorSet.
 0288  61 01 1a 73 70 65 63 69                 - a..speci
 0290  65 73 09 61 00 1a 69 6e                 - es.a..in
 0298  64 65 78 12 12 03 26 5f                 - dex...&_
 02a0  5f 33 67 6b 6a 65 38 54                 - _3gkje8T
 02a8  5f 52 61 63 65 0a 12 00                 - _Race...
 02b0  27 54 5f 52 61 63 65 04                 - 'T_Race.
 02b8  20 06 28 08 60 05 00 47                 -  .(.`..G
 02c0  02 00 00 0f 62 46 02 1d                 - ....bF..
 02c8  61 74 6d 6f 73 70 68 65                 - atmosphe
 02d0  72 65 0d 62 44 02 1b 72                 - re.bD..r
 02d8  61 63 65 73 4e 75 6d 09                 - acesNum.
 02e0  61 06 29 72 61 63 65 73                 - a.)races
 02e8  16 61 04 1b 5f 63 6f 6d                 - .a.._com
 02f0  62 61 74 53 65 61 72 63                 - batSearc
 02f8  68 49 6e 64 65 78 07 61                 - hIndex.a
 0300  00 0c 64 61 79 12 12 03                 - ..day...
 0308  2a 5f 5f 32 66 68 32 75                 - *__2fh2u
 0310  30 54 5f 47 61 6d 65 0a                 - 0T_Game.
 0318  12 00 2b 54 5f 47 61 6d                 - ..+T_Gam
 0320  65 08 60 05 00 0c 00 00                 - e.`.....
 0328  00 0e 61 0a 1b 55 6e 6b                 - ..a..Unk
 0330  6e 6f 77 6e 5f 43 31 0e                 - nown_C1.
 0338  61 08 1b 55 6e 6b 6e 6f                 - a..Unkno
 0340  77 6e 5f 42 46 0e 61 06                 - wn_BF.a.
 0348  1b 55 6e 6b 6e 6f 77 6e                 - .Unknown
 0350  5f 42 44 0e 61 04 1b 55                 - _BD.a..U
 0358  6e 6b 6e 6f 77 6e 5f 42                 - nknown_B
 0360  42 0e 61 00 0c 55 6e 6b                 - B.a..Unk
 0368  6e 6f 77 6e 5f 42 37 15                 - nown_B7.
 0370  12 03 2d 5f 5f 31 6f 70                 - ..-__1op
 0378  72 63 31 54 5f 57 6e 64                 - rc1T_Wnd
 0380  32 31 4e 57 0d 12 00 2e                 - 21NW....
 0388  54 5f 57 6e 64 32 31 4e                 - T_Wnd21N
 0390  57 03 46 2f 0d 12 00 30                 - W.F/...0
 0398  50 5f 57 6e 64 32 31 4e                 - P_Wnd21N
 03a0  57 05 72 12 01 31 04 72                 - W.r..1.r
 03a8  12 00 02 14                             - ....

No disassembly errors

------------------------------------------------------------

Segment: $$TYPES  BYTE USE16  00000028 bytes  
 0000  00 00 01 00 00 00 43 3a                 - ......C:
 0008  5c 57 41 54 43 4f 4d 5c                 - \WATCOM\
 0010  50 52 4f 4a 45 43 54 53                 - PROJECTS
 0018  5c 4c 4f 4f 50 53 5c 6d                 - \LOOPS\m
 0020  61 69 6e 2e 63 70 70 00                 - ain.cpp.

No disassembly errors

------------------------------------------------------------
